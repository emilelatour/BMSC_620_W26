{
  "hash": "a9cec030a5d2712fe47e3af9558e4fe6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data Wrangling and Visualization\"\nsubtitle: \"Working with the tidyverse\"\ndate: \"today\"\nformat: \n  html:\n    toc: true\n    toc-location: left\n    code-fold: false\n    theme: default\n---\n\n\n\n\n## Overview\n\nToday we'll learn tools for:\n\n- **Data wrangling** with `dplyr` (manipulating data)\n- **Summary tables** with `janitor` and `rstatix` (easier summaries)\n- **Data visualization** with `ggplot2` (making plots)\n\n---\n\n## Setup\n\nFirst, load the packages we'll use today:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"tidyverse\")\n# install.packages(\"janitor\")\n# install.packages(\"rstatix\")\n# install.packages(\"skimr\")\n\n# Packages for class\nlibrary(dplyr)    # Part of tidyverse\nlibrary(ggplot2)  # Part of tidyverse\nlibrary(janitor)  # for working with dirty data \nlibrary(rstatix)  # Pipe-Friendly Framework for Basic Statistical Tests\nlibrary(skimr)    # Compact and Flexible Summaries of Data\n\n# Text book package with datasets\nlibrary(oibiostat)\n```\n:::\n\n\n\n\nLoad the NHANES data:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"nhanes.samp.adult\")\n```\n:::\n\n\n\n\n**Your notes:**\n\n\n\n\n---\n\n## Exploring the data\n\n### glimpse()\n\n`glimpse()` is the tidyverse version of `str()`. It shows you the structure of your data.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(nhanes.samp.adult)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 135\nColumns: 76\n$ ID               <int> 63147, 57165, 69465, 57313, 56047, 57056, 54643, 5309…\n$ SurveyYr         <fct> 2011_12, 2009_10, 2011_12, 2009_10, 2009_10, 2009_10,…\n$ Gender           <fct> male, male, female, female, female, male, female, fem…\n$ Age              <int> 41, 48, 50, 74, 27, 26, 41, 52, 56, 39, 32, 72, 35, 2…\n$ AgeDecade        <fct>  40-49,  40-49,  50-59,  70+,  20-29,  20-29,  40-49,…\n$ AgeMonths        <int> NA, 586, NA, 889, 329, 316, 503, 632, NA, 472, 391, 8…\n$ Race1            <fct> White, Black, White, White, White, Mexican, White, Wh…\n$ Race3            <fct> White, NA, White, NA, NA, NA, NA, NA, White, NA, NA, …\n$ Education        <fct> Some College, High School, College Grad, College Grad…\n$ MaritalStatus    <fct> Married, Married, Divorced, Widowed, NeverMarried, Ne…\n$ HHIncome         <fct> 25000-34999, 25000-34999, 35000-44999, 45000-54999, 7…\n$ HHIncomeMid      <int> 30000, 30000, 40000, 50000, 87500, 12500, 60000, 2500…\n$ Poverty          <dbl> 1.41, 1.36, 2.16, 4.16, 3.51, 0.39, 2.33, 0.05, 5.00,…\n$ HomeRooms        <int> 6, 6, 10, 7, 7, 5, 9, 6, 7, 6, 4, 12, 6, 6, 8, 1, 5, …\n$ HomeOwn          <fct> Own, Own, Own, Own, Own, Own, Own, Other, Own, Own, R…\n$ Work             <fct> NotWorking, NotWorking, NotWorking, NotWorking, Worki…\n$ Weight           <dbl> 106.8, 77.4, 70.5, 61.7, 70.3, 92.6, 55.6, 82.0, 88.2…\n$ Length           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ HeadCirc         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ Height           <dbl> 188.8, 168.2, 161.8, 158.1, 168.1, 165.8, 155.6, 156.…\n$ BMI              <dbl> 30.00, 27.36, 26.90, 24.68, 24.88, 33.69, 22.96, 33.5…\n$ BMICatUnder20yrs <fct> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ BMI_WHO          <fct> NA, 25.0_to_29.9, 25.0_to_29.9, 18.5_to_24.9, 18.5_to…\n$ Pulse            <int> 88, 70, 76, 64, 74, 78, 82, 96, 44, 60, 72, 88, 66, 6…\n$ BPSysAve         <int> 112, 123, 152, 132, 107, 126, 111, 114, 137, 122, 124…\n$ BPDiaAve         <int> 76, 69, 103, 81, 58, 75, 76, 71, 77, 78, 89, 66, 66, …\n$ BPSys1           <int> 114, 128, 144, 146, 106, 126, 116, 116, 134, 124, 128…\n$ BPDia1           <int> 78, 78, 104, 84, 62, 86, 72, 66, 78, 70, 94, 72, 62, …\n$ BPSys2           <int> 114, 126, 150, 130, 108, 130, 112, 116, 140, 120, 124…\n$ BPDia2           <int> 76, 76, 106, 80, 52, 74, 76, 72, 76, 80, 90, 64, 66, …\n$ BPSys3           <int> 110, 120, 154, 134, 106, 122, 110, 112, 134, 124, 124…\n$ BPDia3           <int> 76, 62, 100, 82, 64, 76, 76, 70, 78, 76, 88, 68, 66, …\n$ Testosterone     <dbl> 390.16, NA, 8.17, NA, NA, NA, NA, NA, 327.89, NA, NA,…\n$ DirectChol       <dbl> 1.19, 1.22, 2.43, NA, 1.84, 1.40, 1.24, 1.60, 1.11, 0…\n$ TotChol          <dbl> 4.84, 3.75, 5.92, NA, 4.78, 6.96, 5.77, 6.03, 5.25, 5…\n$ UrineVol1        <int> 57, 49, 30, 33, 150, 100, 17, 56, 104, 272, 120, 29, …\n$ UrineFlow1       <dbl> 0.074, 0.551, 1.304, 0.673, 0.342, 0.917, 0.283, 0.34…\n$ UrineVol2        <int> NA, NA, 114, 122, NA, NA, 61, NA, NA, NA, NA, 49, NA,…\n$ UrineFlow2       <dbl> NA, NA, 1.118, 1.220, NA, NA, 0.407, NA, NA, NA, NA, …\n$ Diabetes         <fct> No, No, No, No, No, No, No, No, No, No, Yes, No, No, …\n$ DiabetesAge      <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ HealthGen        <fct> Fair, Fair, Vgood, Vgood, Fair, Fair, Good, Fair, NA,…\n$ DaysPhysHlthBad  <int> 12, 20, 0, 0, 2, 0, 4, 0, NA, 0, 20, 2, 0, 2, NA, 7, …\n$ DaysMentHlthBad  <int> 30, 30, 0, 0, 0, 0, 5, 5, NA, 0, 10, 0, 8, 3, NA, 14,…\n$ LittleInterest   <fct> Several, None, None, None, None, Several, Several, No…\n$ Depressed        <fct> Several, None, None, None, None, None, Several, Most,…\n$ nPregnancies     <int> NA, NA, 3, 3, 2, NA, 3, 2, NA, NA, 7, 3, NA, NA, NA, …\n$ nBabies          <int> NA, NA, 3, 3, 2, NA, 3, 2, NA, NA, 2, 3, NA, NA, NA, …\n$ Age1stBaby       <int> NA, NA, 27, 23, 17, NA, 31, 22, NA, NA, 23, 20, NA, N…\n$ SleepHrsNight    <int> 9, 3, 6, 6, 6, 6, 6, 4, 7, 4, 8, 8, 7, 6, 4, 4, 5, 8,…\n$ SleepTrouble     <fct> Yes, Yes, Yes, No, No, No, No, Yes, No, No, No, No, Y…\n$ PhysActive       <fct> No, Yes, Yes, Yes, No, No, No, No, Yes, No, Yes, No, …\n$ PhysActiveDays   <int> NA, 3, 4, 7, NA, NA, NA, NA, 4, NA, 3, NA, NA, NA, NA…\n$ TVHrsDay         <fct> 1_hr, NA, 1_hr, NA, NA, NA, NA, NA, 2_hr, NA, NA, NA,…\n$ CompHrsDay       <fct> 1_hr, NA, 1_hr, NA, NA, NA, NA, NA, More_4_hr, NA, NA…\n$ TVHrsDayChild    <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ CompHrsDayChild  <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ Alcohol12PlusYr  <fct> Yes, Yes, Yes, Yes, Yes, Yes, No, Yes, NA, Yes, Yes, …\n$ AlcoholDay       <int> 2, NA, 1, 1, 5, 12, 1, 12, NA, NA, NA, 1, 1, 11, NA, …\n$ AlcoholYear      <int> 2, 0, 364, 52, 24, 168, 4, 364, NA, 0, 0, 4, 2, 52, N…\n$ SmokeNow         <fct> NA, No, NA, No, Yes, Yes, No, Yes, NA, NA, NA, NA, NA…\n$ Smoke100         <fct> No, Yes, No, Yes, Yes, Yes, Yes, Yes, No, No, No, No,…\n$ Smoke100n        <fct> Non-Smoker, Smoker, Non-Smoker, Smoker, Smoker, Smoke…\n$ SmokeAge         <int> NA, 11, NA, 18, 14, 14, 10, 30, NA, NA, NA, NA, NA, N…\n$ Marijuana        <fct> Yes, Yes, No, NA, Yes, Yes, Yes, No, NA, No, Yes, NA,…\n$ AgeFirstMarij    <int> 16, 17, NA, NA, 11, 14, 11, NA, NA, NA, 17, NA, NA, 2…\n$ RegularMarij     <fct> No, Yes, No, NA, Yes, Yes, Yes, No, NA, No, Yes, NA, …\n$ AgeRegMarij      <int> NA, 17, NA, NA, 16, 14, 11, NA, NA, NA, 20, NA, NA, N…\n$ HardDrugs        <fct> Yes, No, No, NA, No, Yes, No, No, NA, No, Yes, NA, No…\n$ SexEver          <fct> Yes, Yes, Yes, NA, Yes, Yes, Yes, Yes, NA, Yes, Yes, …\n$ SexAge           <int> 15, 17, 17, NA, 13, 15, 15, 17, NA, 21, 16, NA, 17, 1…\n$ SexNumPartnLife  <int> 50, 81, 4, NA, 10, 8, 3, 5, NA, 5, 45, NA, 4, 1, NA, …\n$ SexNumPartYear   <int> 1, 10, 1, NA, 3, 1, 1, 0, NA, 5, 2, NA, 1, 1, NA, 2, …\n$ SameSex          <fct> No, No, No, NA, No, No, No, No, NA, No, Yes, NA, No, …\n$ SexOrientation   <fct> Heterosexual, Heterosexual, Heterosexual, NA, Heteros…\n$ PregnantNow      <fct> NA, NA, NA, NA, No, NA, No, NA, NA, NA, No, NA, NA, N…\n```\n\n\n:::\n:::\n\n\n\n\n**Your notes:**\n\n\n### skim()\n\n`skim()` from the skimr package gives you a comprehensive summary of your data, including summary statistics and mini histograms.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nskim(nhanes.samp.adult)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |                  |\n|:------------------------|:-----------------|\n|Name                     |nhanes.samp.adult |\n|Number of rows           |135               |\n|Number of columns        |76                |\n|_______________________  |                  |\n|Column type frequency:   |                  |\n|factor                   |31                |\n|numeric                  |45                |\n|________________________ |                  |\n|Group variables          |None              |\n\n\n**Variable type: factor**\n\n|skim_variable    | n_missing| complete_rate|ordered | n_unique|top_counts                         |\n|:----------------|---------:|-------------:|:-------|--------:|:----------------------------------|\n|SurveyYr         |         0|          1.00|FALSE   |        2|201: 69, 200: 66                   |\n|Gender           |         0|          1.00|FALSE   |        2|fem: 70, mal: 65                   |\n|AgeDecade        |         2|          0.99|FALSE   |        6|20: 32,  30: 29,  50: 25,  40: 23  |\n|Race1            |         0|          1.00|FALSE   |        5|Whi: 95, Bla: 12, Mex: 11, Oth: 9  |\n|Race3            |        66|          0.51|FALSE   |        6|Whi: 49, His: 6, Mex: 6, Bla: 5    |\n|Education        |         0|          1.00|FALSE   |        5|Col: 46, Som: 39, Hig: 27, 9 -: 16 |\n|MaritalStatus    |         0|          1.00|FALSE   |        6|Mar: 78, Nev: 25, Div: 13, Liv: 13 |\n|HHIncome         |        10|          0.93|FALSE   |       12|mor: 27, 350: 18, 250: 14, 750: 14 |\n|HomeOwn          |         0|          1.00|FALSE   |        3|Own: 88, Ren: 43, Oth: 4           |\n|Work             |         0|          1.00|FALSE   |        3|Wor: 90, Not: 40, Loo: 5           |\n|BMICatUnder20yrs |       135|          0.00|FALSE   |        0|Und: 0, Nor: 0, Ove: 0, Obe: 0     |\n|BMI_WHO          |         1|          0.99|FALSE   |        4|30.: 49, 25.: 46, 18.: 35, 12.: 4  |\n|Diabetes         |         0|          1.00|FALSE   |        2|No: 122, Yes: 13                   |\n|HealthGen        |        11|          0.92|FALSE   |        5|Goo: 45, Vgo: 32, Fai: 30, Exc: 16 |\n|LittleInterest   |        11|          0.92|FALSE   |        3|Non: 92, Sev: 27, Mos: 5           |\n|Depressed        |        11|          0.92|FALSE   |        3|Non: 94, Sev: 21, Mos: 9           |\n|SleepTrouble     |         0|          1.00|FALSE   |        2|No: 99, Yes: 36                    |\n|PhysActive       |         0|          1.00|FALSE   |        2|Yes: 76, No: 59                    |\n|TVHrsDay         |        66|          0.51|FALSE   |        7|1_h: 15, 2_h: 15, 3_h: 15, 4_h: 10 |\n|CompHrsDay       |        66|          0.51|FALSE   |        7|0_h: 16, 0_t: 14, 1_h: 14, 2_h: 12 |\n|Alcohol12PlusYr  |        11|          0.92|FALSE   |        2|Yes: 102, No: 22                   |\n|SmokeNow         |        70|          0.48|FALSE   |        2|Yes: 36, No: 29                    |\n|Smoke100         |         0|          1.00|FALSE   |        2|No: 70, Yes: 65                    |\n|Smoke100n        |         0|          1.00|FALSE   |        2|Non: 70, Smo: 65                   |\n|Marijuana        |        38|          0.72|FALSE   |        2|Yes: 58, No: 39                    |\n|RegularMarij     |        38|          0.72|FALSE   |        2|No: 65, Yes: 32                    |\n|HardDrugs        |        26|          0.81|FALSE   |        2|No: 87, Yes: 22                    |\n|SexEver          |        26|          0.81|FALSE   |        2|Yes: 106, No: 3                    |\n|SameSex          |        26|          0.81|FALSE   |        2|No: 103, Yes: 6                    |\n|SexOrientation   |        41|          0.70|FALSE   |        2|Het: 93, Bis: 1, Hom: 0            |\n|PregnantNow      |        95|          0.30|FALSE   |        2|No: 38, Yes: 2, Unk: 0             |\n\n\n**Variable type: numeric**\n\n|skim_variable   | n_missing| complete_rate|     mean|       sd|       p0|      p25|      p50|      p75|      p100|hist  |\n|:---------------|---------:|-------------:|--------:|--------:|--------:|--------:|--------:|--------:|---------:|:-----|\n|ID              |         0|          1.00| 62139.76|  5722.89| 51780.00| 57277.00| 62229.00| 67475.00|  71581.00|▆▆▇▅▇ |\n|Age             |         0|          1.00|    44.47|    16.07|    21.00|    30.50|    42.00|    57.00|     80.00|▇▆▆▅▃ |\n|AgeMonths       |        70|          0.48|   519.66|   188.92|   259.00|   332.00|   486.00|   683.00|    910.00|▇▆▃▅▂ |\n|HHIncomeMid     |        10|          0.93| 57180.00| 31608.39|  2500.00| 30000.00| 50000.00| 87500.00| 100000.00|▃▇▃▂▇ |\n|Poverty         |        11|          0.92|     2.78|     1.70|     0.00|     1.28|     2.71|     4.82|      5.00|▅▆▅▂▇ |\n|HomeRooms       |         0|          1.00|     5.96|     2.31|     1.00|     4.50|     6.00|     7.00|     13.00|▂▅▇▂▁ |\n|Weight          |         0|          1.00|    83.96|    23.72|    39.70|    67.45|    80.70|    98.50|    187.50|▅▇▃▁▁ |\n|Length          |       135|          0.00|      NaN|       NA|       NA|       NA|       NA|       NA|        NA|      |\n|HeadCirc        |       135|          0.00|      NaN|       NA|       NA|       NA|       NA|       NA|        NA|      |\n|Height          |         0|          1.00|   169.49|     9.95|   140.00|   162.55|   168.50|   177.80|    191.30|▁▃▇▅▃ |\n|BMI             |         0|          1.00|    29.10|     7.55|    17.10|    24.24|    27.90|    33.46|     69.00|▇▆▂▁▁ |\n|Pulse           |         4|          0.97|    73.11|    12.58|    44.00|    64.00|    72.00|    80.00|    116.00|▂▇▇▂▁ |\n|BPSysAve        |         5|          0.96|   120.74|    17.10|    91.00|   110.00|   120.00|   129.00|    202.00|▆▇▂▁▁ |\n|BPDiaAve        |         5|          0.96|    71.18|    11.36|    21.00|    65.00|    71.00|    78.00|    103.00|▁▁▇▇▁ |\n|BPSys1          |        11|          0.92|   121.69|    17.97|    90.00|   110.00|   119.00|   130.00|    202.00|▅▇▂▁▁ |\n|BPDia1          |        11|          0.92|    71.35|    11.65|    42.00|    64.00|    71.00|    78.00|    108.00|▂▇▇▃▁ |\n|BPSys2          |         7|          0.95|   121.33|    17.30|    90.00|   110.00|   119.00|   130.00|    204.00|▆▇▂▁▁ |\n|BPDia2          |         7|          0.95|    71.59|    11.15|    40.00|    65.50|    72.00|    78.00|    106.00|▁▅▇▃▁ |\n|BPSys3          |         8|          0.94|   120.63|    17.23|    90.00|   110.00|   118.00|   128.00|    200.00|▆▇▂▁▁ |\n|BPDia3          |         8|          0.94|    70.58|    12.40|     0.00|    64.00|    70.00|    78.00|    100.00|▁▁▂▇▂ |\n|Testosterone    |        67|          0.50|   195.32|   196.22|     7.21|    20.92|   137.92|   322.30|    651.53|▇▃▂▁▂ |\n|DirectChol      |         3|          0.98|     1.39|     0.45|     0.70|     1.09|     1.29|     1.60|      3.72|▇▆▂▁▁ |\n|TotChol         |         3|          0.98|     5.16|     1.05|     3.18|     4.40|     5.08|     5.80|      8.77|▅▇▆▁▁ |\n|UrineVol1       |         1|          0.99|   119.96|    93.90|     1.00|    49.25|    94.50|   162.50|    402.00|▇▆▂▂▁ |\n|UrineFlow1      |         5|          0.96|     1.14|     1.42|     0.01|     0.37|     0.74|     1.29|     12.35|▇▁▁▁▁ |\n|UrineVol2       |       112|          0.17|    98.78|    72.73|    23.00|    54.00|    63.00|   123.50|    314.00|▇▃▁▁▁ |\n|UrineFlow2      |       112|          0.17|     0.90|     0.74|     0.14|     0.42|     0.55|     1.17|      2.80|▇▂▁▁▁ |\n|DiabetesAge     |       124|          0.08|    41.45|    15.44|    12.00|    32.50|    42.00|    52.50|     63.00|▂▅▇▅▇ |\n|DaysPhysHlthBad |        11|          0.92|     3.85|     8.18|     0.00|     0.00|     0.00|     2.00|     30.00|▇▁▁▁▁ |\n|DaysMentHlthBad |        11|          0.92|     5.02|     8.66|     0.00|     0.00|     0.00|     5.00|     30.00|▇▁▁▁▁ |\n|nPregnancies    |        86|          0.36|     3.10|     1.62|     1.00|     2.00|     3.00|     4.00|      7.00|▇▆▂▁▂ |\n|nBabies         |        88|          0.35|     2.23|     1.05|     0.00|     2.00|     2.00|     3.00|      6.00|▃▇▃▁▁ |\n|Age1stBaby      |        97|          0.28|    23.45|     4.92|    16.00|    20.00|    23.00|    26.00|     34.00|▅▇▅▂▃ |\n|SleepHrsNight   |         0|          1.00|     6.90|     1.39|     2.00|     6.00|     7.00|     8.00|     11.00|▁▁▇▅▁ |\n|PhysActiveDays  |        69|          0.49|     3.91|     1.76|     1.00|     3.00|     4.00|     5.00|      7.00|▇▇▃▇▆ |\n|TVHrsDayChild   |       135|          0.00|      NaN|       NA|       NA|       NA|       NA|       NA|        NA|      |\n|CompHrsDayChild |       135|          0.00|      NaN|       NA|       NA|       NA|       NA|       NA|        NA|      |\n|AlcoholDay      |        38|          0.72|     3.10|     2.84|     1.00|     1.00|     2.00|     5.00|     12.00|▇▂▁▁▁ |\n|AlcoholYear     |        21|          0.84|    74.60|   102.54|     0.00|     3.00|    24.00|   104.00|    364.00|▇▁▂▁▁ |\n|SmokeAge        |        73|          0.46|    17.50|     5.60|     7.00|    14.00|    16.50|    19.00|     45.00|▃▇▁▁▁ |\n|AgeFirstMarij   |        77|          0.43|    17.00|     4.85|     9.00|    15.00|    16.00|    19.00|     46.00|▇▇▁▁▁ |\n|AgeRegMarij     |       103|          0.24|    18.03|     6.19|    11.00|    15.00|    17.00|    19.25|     46.00|▇▃▁▁▁ |\n|SexAge          |        29|          0.79|    16.94|     3.11|     9.00|    15.00|    17.00|    19.00|     33.00|▂▇▃▁▁ |\n|SexNumPartnLife |        26|          0.81|    25.41|    93.67|     0.00|     3.00|     6.00|    13.00|    800.00|▇▁▁▁▁ |\n|SexNumPartYear  |        38|          0.72|     1.27|     1.33|     0.00|     1.00|     1.00|     1.00|     10.00|▇▁▁▁▁ |\n\n\n:::\n:::\n\n\n\n\n**Your notes:**\n\n---\n\n## Tibbles\n\nA **tibble** is the tidyverse version of a data frame. It's essentially the same thing, just with nicer printing.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Print the data\nnhanes.samp.adult\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 135 × 76\n      ID SurveyYr Gender   Age AgeDecade AgeMonths Race1   Race3 Education     \n * <int> <fct>    <fct>  <int> <fct>         <int> <fct>   <fct> <fct>         \n 1 63147 2011_12  male      41 \" 40-49\"         NA White   White Some College  \n 2 57165 2009_10  male      48 \" 40-49\"        586 Black   <NA>  High School   \n 3 69465 2011_12  female    50 \" 50-59\"         NA White   White College Grad  \n 4 57313 2009_10  female    74 \" 70+\"          889 White   <NA>  College Grad  \n 5 56047 2009_10  female    27 \" 20-29\"        329 White   <NA>  9 - 11th Grade\n 6 57056 2009_10  male      26 \" 20-29\"        316 Mexican <NA>  High School   \n 7 54643 2009_10  female    41 \" 40-49\"        503 White   <NA>  College Grad  \n 8 53095 2009_10  female    52 \" 50-59\"        632 White   <NA>  9 - 11th Grade\n 9 67434 2011_12  male      56 \" 50-59\"         NA White   White College Grad  \n10 60273 2009_10  male      39 \" 30-39\"        472 Black   <NA>  9 - 11th Grade\n# ℹ 125 more rows\n# ℹ 67 more variables: MaritalStatus <fct>, HHIncome <fct>, HHIncomeMid <int>,\n#   Poverty <dbl>, HomeRooms <int>, HomeOwn <fct>, Work <fct>, Weight <dbl>,\n#   Length <dbl>, HeadCirc <dbl>, Height <dbl>, BMI <dbl>,\n#   BMICatUnder20yrs <fct>, BMI_WHO <fct>, Pulse <int>, BPSysAve <int>,\n#   BPDiaAve <int>, BPSys1 <int>, BPDia1 <int>, BPSys2 <int>, BPDia2 <int>,\n#   BPSys3 <int>, BPDia3 <int>, Testosterone <dbl>, DirectChol <dbl>, …\n```\n\n\n:::\n:::\n\n\n\n\n**Your notes:**\n\n\n\n\n---\n\n## The Pipe Operator: `%>%`\n\nThe pipe operator `%>%` takes the output from one function and passes it as input to the next function.\n\nThink of it as: \"and then...\"\n\n### Without pipes (nested functions)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read from inside-out\nhead(nhanes.samp.adult)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 76\n     ID SurveyYr Gender   Age AgeDecade AgeMonths Race1   Race3 Education     \n  <int> <fct>    <fct>  <int> <fct>         <int> <fct>   <fct> <fct>         \n1 63147 2011_12  male      41 \" 40-49\"         NA White   White Some College  \n2 57165 2009_10  male      48 \" 40-49\"        586 Black   <NA>  High School   \n3 69465 2011_12  female    50 \" 50-59\"         NA White   White College Grad  \n4 57313 2009_10  female    74 \" 70+\"          889 White   <NA>  College Grad  \n5 56047 2009_10  female    27 \" 20-29\"        329 White   <NA>  9 - 11th Grade\n6 57056 2009_10  male      26 \" 20-29\"        316 Mexican <NA>  High School   \n# ℹ 67 more variables: MaritalStatus <fct>, HHIncome <fct>, HHIncomeMid <int>,\n#   Poverty <dbl>, HomeRooms <int>, HomeOwn <fct>, Work <fct>, Weight <dbl>,\n#   Length <dbl>, HeadCirc <dbl>, Height <dbl>, BMI <dbl>,\n#   BMICatUnder20yrs <fct>, BMI_WHO <fct>, Pulse <int>, BPSysAve <int>,\n#   BPDiaAve <int>, BPSys1 <int>, BPDia1 <int>, BPSys2 <int>, BPDia2 <int>,\n#   BPSys3 <int>, BPDia3 <int>, Testosterone <dbl>, DirectChol <dbl>,\n#   TotChol <dbl>, UrineVol1 <int>, UrineFlow1 <dbl>, UrineVol2 <int>, …\n```\n\n\n:::\n:::\n\n\n\n\n### With pipes\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read from left to right (or top to bottom)\nnhanes.samp.adult %>% \n  head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 76\n     ID SurveyYr Gender   Age AgeDecade AgeMonths Race1   Race3 Education     \n  <int> <fct>    <fct>  <int> <fct>         <int> <fct>   <fct> <fct>         \n1 63147 2011_12  male      41 \" 40-49\"         NA White   White Some College  \n2 57165 2009_10  male      48 \" 40-49\"        586 Black   <NA>  High School   \n3 69465 2011_12  female    50 \" 50-59\"         NA White   White College Grad  \n4 57313 2009_10  female    74 \" 70+\"          889 White   <NA>  College Grad  \n5 56047 2009_10  female    27 \" 20-29\"        329 White   <NA>  9 - 11th Grade\n6 57056 2009_10  male      26 \" 20-29\"        316 Mexican <NA>  High School   \n# ℹ 67 more variables: MaritalStatus <fct>, HHIncome <fct>, HHIncomeMid <int>,\n#   Poverty <dbl>, HomeRooms <int>, HomeOwn <fct>, Work <fct>, Weight <dbl>,\n#   Length <dbl>, HeadCirc <dbl>, Height <dbl>, BMI <dbl>,\n#   BMICatUnder20yrs <fct>, BMI_WHO <fct>, Pulse <int>, BPSysAve <int>,\n#   BPDiaAve <int>, BPSys1 <int>, BPDia1 <int>, BPSys2 <int>, BPDia2 <int>,\n#   BPSys3 <int>, BPDia3 <int>, Testosterone <dbl>, DirectChol <dbl>,\n#   TotChol <dbl>, UrineVol1 <int>, UrineFlow1 <dbl>, UrineVol2 <int>, …\n```\n\n\n:::\n:::\n\n\n\n\n**Your notes:**\n\n\n\n\n---\n\n## dplyr: The main verbs\n\nThe `dplyr` package gives us functions (verbs) for manipulating data:\n\n- `filter()` - keep rows that meet a condition\n- `select()` - keep or drop columns\n- `mutate()` - create new columns or modify existing ones\n- `group_by()` - group data for analysis\n- `arrange()` - sort rows\n\n---\n\n## filter()\n\n`filter()` keeps rows that meet certain conditions.\n\n### Filter to one condition\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Keep only people with diabetes\nnhanes.samp.adult %>%\n  filter(Diabetes == \"Yes\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 13 × 76\n      ID SurveyYr Gender   Age AgeDecade AgeMonths Race1   Race3   Education    \n   <int> <fct>    <fct>  <int> <fct>         <int> <fct>   <fct>   <fct>        \n 1 58162 2009_10  female    32 \" 30-39\"        391 White   <NA>    Some College \n 2 58845 2009_10  male      63 \" 60-69\"        760 White   <NA>    9 - 11th Gra…\n 3 59541 2009_10  male      49 \" 40-49\"        593 White   <NA>    High School  \n 4 71581 2011_12  male      36 \" 30-39\"         NA Mexican Mexican High School  \n 5 70064 2011_12  female    38 \" 30-39\"         NA White   White   High School  \n 6 53154 2009_10  male      55 \" 50-59\"        665 White   <NA>    Some College \n 7 55436 2009_10  female    57 \" 50-59\"        694 Other   <NA>    8th Grade    \n 8 56254 2009_10  female    59 \" 50-59\"        714 White   <NA>    9 - 11th Gra…\n 9 67668 2011_12  female    70 \" 70+\"           NA White   White   Some College \n10 60854 2009_10  female    61 \" 60-69\"        742 White   <NA>    High School  \n11 57287 2009_10  female    33 \" 30-39\"        398 White   <NA>    Some College \n12 63288 2011_12  female    58 \" 50-59\"         NA Black   Black   College Grad \n13 61687 2009_10  male      57 \" 50-59\"        693 White   <NA>    High School  \n# ℹ 67 more variables: MaritalStatus <fct>, HHIncome <fct>, HHIncomeMid <int>,\n#   Poverty <dbl>, HomeRooms <int>, HomeOwn <fct>, Work <fct>, Weight <dbl>,\n#   Length <dbl>, HeadCirc <dbl>, Height <dbl>, BMI <dbl>,\n#   BMICatUnder20yrs <fct>, BMI_WHO <fct>, Pulse <int>, BPSysAve <int>,\n#   BPDiaAve <int>, BPSys1 <int>, BPDia1 <int>, BPSys2 <int>, BPDia2 <int>,\n#   BPSys3 <int>, BPDia3 <int>, Testosterone <dbl>, DirectChol <dbl>,\n#   TotChol <dbl>, UrineVol1 <int>, UrineFlow1 <dbl>, UrineVol2 <int>, …\n```\n\n\n:::\n:::\n\n\n\n\n### Filter with multiple conditions\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Keep only females over age 50\nnhanes.samp.adult %>%\n  filter(Gender == \"female\", Age > 50)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 23 × 76\n      ID SurveyYr Gender   Age AgeDecade AgeMonths Race1    Race3    Education  \n   <int> <fct>    <fct>  <int> <fct>         <int> <fct>    <fct>    <fct>      \n 1 57313 2009_10  female    74 \" 70+\"          889 White    <NA>     College Gr…\n 2 53095 2009_10  female    52 \" 50-59\"        632 White    <NA>     9 - 11th G…\n 3 58284 2009_10  female    72 \" 70+\"          868 White    <NA>     College Gr…\n 4 67285 2011_12  female    70 \" 70+\"           NA Hispanic Hispanic College Gr…\n 5 63510 2011_12  female    56 \" 50-59\"         NA White    White    Some Colle…\n 6 59171 2009_10  female    74 \" 70+\"          897 White    <NA>     High School\n 7 58824 2009_10  female    59 \" 50-59\"        712 White    <NA>     High School\n 8 64676 2011_12  female    56 \" 50-59\"         NA Hispanic Hispanic Some Colle…\n 9 55436 2009_10  female    57 \" 50-59\"        694 Other    <NA>     8th Grade  \n10 56254 2009_10  female    59 \" 50-59\"        714 White    <NA>     9 - 11th G…\n# ℹ 13 more rows\n# ℹ 67 more variables: MaritalStatus <fct>, HHIncome <fct>, HHIncomeMid <int>,\n#   Poverty <dbl>, HomeRooms <int>, HomeOwn <fct>, Work <fct>, Weight <dbl>,\n#   Length <dbl>, HeadCirc <dbl>, Height <dbl>, BMI <dbl>,\n#   BMICatUnder20yrs <fct>, BMI_WHO <fct>, Pulse <int>, BPSysAve <int>,\n#   BPDiaAve <int>, BPSys1 <int>, BPDia1 <int>, BPSys2 <int>, BPDia2 <int>,\n#   BPSys3 <int>, BPDia3 <int>, Testosterone <dbl>, DirectChol <dbl>, …\n```\n\n\n:::\n:::\n\n\n\n\n### Other comparison operators\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Greater than or equal to\nnhanes.samp.adult %>%\n  filter(BMI >= 30)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 50 × 76\n      ID SurveyYr Gender   Age AgeDecade AgeMonths Race1    Race3    Education  \n   <int> <fct>    <fct>  <int> <fct>         <int> <fct>    <fct>    <fct>      \n 1 63147 2011_12  male      41 \" 40-49\"         NA White    White    Some Colle…\n 2 57056 2009_10  male      26 \" 20-29\"        316 Mexican  <NA>     High School\n 3 53095 2009_10  female    52 \" 50-59\"        632 White    <NA>     9 - 11th G…\n 4 60273 2009_10  male      39 \" 30-39\"        472 Black    <NA>     9 - 11th G…\n 5 58162 2009_10  female    32 \" 30-39\"        391 White    <NA>     Some Colle…\n 6 67285 2011_12  female    70 \" 70+\"           NA Hispanic Hispanic College Gr…\n 7 69403 2011_12  male      61 \" 60-69\"         NA White    White    College Gr…\n 8 51912 2009_10  female    27 \" 20-29\"        332 White    <NA>     9 - 11th G…\n 9 71564 2011_12  male      25 \" 20-29\"         NA White    White    High School\n10 58845 2009_10  male      63 \" 60-69\"        760 White    <NA>     9 - 11th G…\n# ℹ 40 more rows\n# ℹ 67 more variables: MaritalStatus <fct>, HHIncome <fct>, HHIncomeMid <int>,\n#   Poverty <dbl>, HomeRooms <int>, HomeOwn <fct>, Work <fct>, Weight <dbl>,\n#   Length <dbl>, HeadCirc <dbl>, Height <dbl>, BMI <dbl>,\n#   BMICatUnder20yrs <fct>, BMI_WHO <fct>, Pulse <int>, BPSysAve <int>,\n#   BPDiaAve <int>, BPSys1 <int>, BPDia1 <int>, BPSys2 <int>, BPDia2 <int>,\n#   BPSys3 <int>, BPDia3 <int>, Testosterone <dbl>, DirectChol <dbl>, …\n```\n\n\n:::\n:::\n\n\n\n\n**Your notes:**\n\n\n\n\n---\n\n## select()\n\n`select()` keeps (or drops) specific columns.\n\n### Select certain columns\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Keep only demographic variables\nnhanes.samp.adult %>%\n  select(Age, Gender, Race1, Education)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 135 × 4\n     Age Gender Race1   Education     \n   <int> <fct>  <fct>   <fct>         \n 1    41 male   White   Some College  \n 2    48 male   Black   High School   \n 3    50 female White   College Grad  \n 4    74 female White   College Grad  \n 5    27 female White   9 - 11th Grade\n 6    26 male   Mexican High School   \n 7    41 female White   College Grad  \n 8    52 female White   9 - 11th Grade\n 9    56 male   White   College Grad  \n10    39 male   Black   9 - 11th Grade\n# ℹ 125 more rows\n```\n\n\n:::\n:::\n\n\n\n\n### Select a range of columns\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Keep columns from Age through Education\nnhanes.samp.adult %>%\n  select(Age:Education)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 135 × 6\n     Age AgeDecade AgeMonths Race1   Race3 Education     \n   <int> <fct>         <int> <fct>   <fct> <fct>         \n 1    41 \" 40-49\"         NA White   White Some College  \n 2    48 \" 40-49\"        586 Black   <NA>  High School   \n 3    50 \" 50-59\"         NA White   White College Grad  \n 4    74 \" 70+\"          889 White   <NA>  College Grad  \n 5    27 \" 20-29\"        329 White   <NA>  9 - 11th Grade\n 6    26 \" 20-29\"        316 Mexican <NA>  High School   \n 7    41 \" 40-49\"        503 White   <NA>  College Grad  \n 8    52 \" 50-59\"        632 White   <NA>  9 - 11th Grade\n 9    56 \" 50-59\"         NA White   White College Grad  \n10    39 \" 30-39\"        472 Black   <NA>  9 - 11th Grade\n# ℹ 125 more rows\n```\n\n\n:::\n:::\n\n\n\n\n### Drop columns\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Drop the ID column\nnhanes.samp.adult %>%\n  select(-ID)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 135 × 75\n   SurveyYr Gender   Age AgeDecade AgeMonths Race1 Race3 Education MaritalStatus\n   <fct>    <fct>  <int> <fct>         <int> <fct> <fct> <fct>     <fct>        \n 1 2011_12  male      41 \" 40-49\"         NA White White Some Col… Married      \n 2 2009_10  male      48 \" 40-49\"        586 Black <NA>  High Sch… Married      \n 3 2011_12  female    50 \" 50-59\"         NA White White College … Divorced     \n 4 2009_10  female    74 \" 70+\"          889 White <NA>  College … Widowed      \n 5 2009_10  female    27 \" 20-29\"        329 White <NA>  9 - 11th… NeverMarried \n 6 2009_10  male      26 \" 20-29\"        316 Mexi… <NA>  High Sch… NeverMarried \n 7 2009_10  female    41 \" 40-49\"        503 White <NA>  College … Married      \n 8 2009_10  female    52 \" 50-59\"        632 White <NA>  9 - 11th… NeverMarried \n 9 2011_12  male      56 \" 50-59\"         NA White White College … Married      \n10 2009_10  male      39 \" 30-39\"        472 Black <NA>  9 - 11th… Married      \n# ℹ 125 more rows\n# ℹ 66 more variables: HHIncome <fct>, HHIncomeMid <int>, Poverty <dbl>,\n#   HomeRooms <int>, HomeOwn <fct>, Work <fct>, Weight <dbl>, Length <dbl>,\n#   HeadCirc <dbl>, Height <dbl>, BMI <dbl>, BMICatUnder20yrs <fct>,\n#   BMI_WHO <fct>, Pulse <int>, BPSysAve <int>, BPDiaAve <int>, BPSys1 <int>,\n#   BPDia1 <int>, BPSys2 <int>, BPDia2 <int>, BPSys3 <int>, BPDia3 <int>,\n#   Testosterone <dbl>, DirectChol <dbl>, TotChol <dbl>, UrineVol1 <int>, …\n```\n\n\n:::\n:::\n\n\n\n\n**Your notes:**\n\n\n\n\n---\n\n## mutate()\n\n`mutate()` creates new columns or modifies existing ones.\n\n**Important:** `mutate()` does NOT change your original data unless you save it!\n\n### Create a new column\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create BMI categories\nnhanes.samp.adult %>%\n  mutate(bmi_category = case_when(\n    BMI < 18.5 ~ \"Underweight\",\n    BMI < 25 ~ \"Normal\",\n    BMI < 30 ~ \"Overweight\",\n    BMI >= 30 ~ \"Obese\"\n  ))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 135 × 77\n      ID SurveyYr Gender   Age AgeDecade AgeMonths Race1   Race3 Education     \n   <int> <fct>    <fct>  <int> <fct>         <int> <fct>   <fct> <fct>         \n 1 63147 2011_12  male      41 \" 40-49\"         NA White   White Some College  \n 2 57165 2009_10  male      48 \" 40-49\"        586 Black   <NA>  High School   \n 3 69465 2011_12  female    50 \" 50-59\"         NA White   White College Grad  \n 4 57313 2009_10  female    74 \" 70+\"          889 White   <NA>  College Grad  \n 5 56047 2009_10  female    27 \" 20-29\"        329 White   <NA>  9 - 11th Grade\n 6 57056 2009_10  male      26 \" 20-29\"        316 Mexican <NA>  High School   \n 7 54643 2009_10  female    41 \" 40-49\"        503 White   <NA>  College Grad  \n 8 53095 2009_10  female    52 \" 50-59\"        632 White   <NA>  9 - 11th Grade\n 9 67434 2011_12  male      56 \" 50-59\"         NA White   White College Grad  \n10 60273 2009_10  male      39 \" 30-39\"        472 Black   <NA>  9 - 11th Grade\n# ℹ 125 more rows\n# ℹ 68 more variables: MaritalStatus <fct>, HHIncome <fct>, HHIncomeMid <int>,\n#   Poverty <dbl>, HomeRooms <int>, HomeOwn <fct>, Work <fct>, Weight <dbl>,\n#   Length <dbl>, HeadCirc <dbl>, Height <dbl>, BMI <dbl>,\n#   BMICatUnder20yrs <fct>, BMI_WHO <fct>, Pulse <int>, BPSysAve <int>,\n#   BPDiaAve <int>, BPSys1 <int>, BPDia1 <int>, BPSys2 <int>, BPDia2 <int>,\n#   BPSys3 <int>, BPDia3 <int>, Testosterone <dbl>, DirectChol <dbl>, …\n```\n\n\n:::\n:::\n\n\n\n\n### Create multiple columns at once\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create height in meters and weight in kg\nnhanes.samp.adult %>%\n  mutate(\n    height_m = Height / 100,\n    weight_kg = Weight * 0.453592\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 135 × 78\n      ID SurveyYr Gender   Age AgeDecade AgeMonths Race1   Race3 Education     \n   <int> <fct>    <fct>  <int> <fct>         <int> <fct>   <fct> <fct>         \n 1 63147 2011_12  male      41 \" 40-49\"         NA White   White Some College  \n 2 57165 2009_10  male      48 \" 40-49\"        586 Black   <NA>  High School   \n 3 69465 2011_12  female    50 \" 50-59\"         NA White   White College Grad  \n 4 57313 2009_10  female    74 \" 70+\"          889 White   <NA>  College Grad  \n 5 56047 2009_10  female    27 \" 20-29\"        329 White   <NA>  9 - 11th Grade\n 6 57056 2009_10  male      26 \" 20-29\"        316 Mexican <NA>  High School   \n 7 54643 2009_10  female    41 \" 40-49\"        503 White   <NA>  College Grad  \n 8 53095 2009_10  female    52 \" 50-59\"        632 White   <NA>  9 - 11th Grade\n 9 67434 2011_12  male      56 \" 50-59\"         NA White   White College Grad  \n10 60273 2009_10  male      39 \" 30-39\"        472 Black   <NA>  9 - 11th Grade\n# ℹ 125 more rows\n# ℹ 69 more variables: MaritalStatus <fct>, HHIncome <fct>, HHIncomeMid <int>,\n#   Poverty <dbl>, HomeRooms <int>, HomeOwn <fct>, Work <fct>, Weight <dbl>,\n#   Length <dbl>, HeadCirc <dbl>, Height <dbl>, BMI <dbl>,\n#   BMICatUnder20yrs <fct>, BMI_WHO <fct>, Pulse <int>, BPSysAve <int>,\n#   BPDiaAve <int>, BPSys1 <int>, BPDia1 <int>, BPSys2 <int>, BPDia2 <int>,\n#   BPSys3 <int>, BPDia3 <int>, Testosterone <dbl>, DirectChol <dbl>, …\n```\n\n\n:::\n:::\n\n\n\n\n**Your notes:**\n\n\n\n\n---\n\n## Combining dplyr verbs\n\nYou can chain multiple operations together with the pipe!\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter, select, and mutate in one pipeline\nnhanes.samp.adult %>%\n  filter(Age >= 40) %>%\n  select(Age, Gender, BMI, Diabetes) %>%\n  mutate(bmi_category = case_when(\n    BMI < 25 ~ \"Normal or underweight\",\n    BMI >= 25 ~ \"Overweight or obese\"\n  ))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 74 × 5\n     Age Gender   BMI Diabetes bmi_category         \n   <int> <fct>  <dbl> <fct>    <chr>                \n 1    41 male    30   No       Overweight or obese  \n 2    48 male    27.4 No       Overweight or obese  \n 3    50 female  26.9 No       Overweight or obese  \n 4    74 female  24.7 No       Normal or underweight\n 5    41 female  23.0 No       Normal or underweight\n 6    52 female  33.5 No       Overweight or obese  \n 7    56 male    26.8 No       Overweight or obese  \n 8    72 female  25.2 No       Overweight or obese  \n 9    49 female  24.4 No       Normal or underweight\n10    49 male    23.8 No       Normal or underweight\n# ℹ 64 more rows\n```\n\n\n:::\n:::\n\n\n\n\n**Your notes:**\n\n\n\n\n---\n\n## group_by()\n\n`group_by()` groups your data by one or more variables. It's most useful when combined with other functions.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Group by gender\nnhanes.samp.adult %>%\n  group_by(Gender)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 135 × 76\n# Groups:   Gender [2]\n      ID SurveyYr Gender   Age AgeDecade AgeMonths Race1   Race3 Education     \n   <int> <fct>    <fct>  <int> <fct>         <int> <fct>   <fct> <fct>         \n 1 63147 2011_12  male      41 \" 40-49\"         NA White   White Some College  \n 2 57165 2009_10  male      48 \" 40-49\"        586 Black   <NA>  High School   \n 3 69465 2011_12  female    50 \" 50-59\"         NA White   White College Grad  \n 4 57313 2009_10  female    74 \" 70+\"          889 White   <NA>  College Grad  \n 5 56047 2009_10  female    27 \" 20-29\"        329 White   <NA>  9 - 11th Grade\n 6 57056 2009_10  male      26 \" 20-29\"        316 Mexican <NA>  High School   \n 7 54643 2009_10  female    41 \" 40-49\"        503 White   <NA>  College Grad  \n 8 53095 2009_10  female    52 \" 50-59\"        632 White   <NA>  9 - 11th Grade\n 9 67434 2011_12  male      56 \" 50-59\"         NA White   White College Grad  \n10 60273 2009_10  male      39 \" 30-39\"        472 Black   <NA>  9 - 11th Grade\n# ℹ 125 more rows\n# ℹ 67 more variables: MaritalStatus <fct>, HHIncome <fct>, HHIncomeMid <int>,\n#   Poverty <dbl>, HomeRooms <int>, HomeOwn <fct>, Work <fct>, Weight <dbl>,\n#   Length <dbl>, HeadCirc <dbl>, Height <dbl>, BMI <dbl>,\n#   BMICatUnder20yrs <fct>, BMI_WHO <fct>, Pulse <int>, BPSysAve <int>,\n#   BPDiaAve <int>, BPSys1 <int>, BPDia1 <int>, BPSys2 <int>, BPDia2 <int>,\n#   BPSys3 <int>, BPDia3 <int>, Testosterone <dbl>, DirectChol <dbl>, …\n```\n\n\n:::\n:::\n\n\n\n\nNote: By itself, `group_by()` doesn't change how the data looks. It sets up groups for the next operation.\n\n**Your notes:**\n\n\n\n\n---\n\n## Summary tables with janitor\n\nThe `janitor` package makes creating frequency tables much easier than base R!\n\n### tabyl() - frequency tables\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# One-way frequency table\nnhanes.samp.adult %>%\n  tabyl(Gender)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Gender  n   percent\n female 70 0.5185185\n   male 65 0.4814815\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Two-way table (cross-tabulation)\nnhanes.samp.adult %>%\n  tabyl(Gender, Diabetes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Gender No Yes\n female 62   8\n   male 60   5\n```\n\n\n:::\n:::\n\n\n\n\n### Adding percentages\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Add row percentages\nnhanes.samp.adult %>%\n  tabyl(Gender, Diabetes) %>%\n  adorn_percentages(\"row\") %>%\n  adorn_pct_formatting(digits = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Gender    No   Yes\n female 88.6% 11.4%\n   male 92.3%  7.7%\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Add totals\nnhanes.samp.adult %>%\n  tabyl(Gender, Diabetes) %>%\n  adorn_totals(c(\"row\", \"col\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Gender  No Yes Total\n female  62   8    70\n   male  60   5    65\n  Total 122  13   135\n```\n\n\n:::\n:::\n\n\n\n\n**Your notes:**\n\n\n\n\n---\n\n## Summary statistics with rstatix\n\nThe `rstatix` package provides easy-to-use functions for summary statistics.\n\n### get_summary_stats()\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Summary stats for BMI\nnhanes.samp.adult %>%\n  get_summary_stats(BMI, type = \"mean_sd\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 4\n  variable     n  mean    sd\n  <fct>    <dbl> <dbl> <dbl>\n1 BMI        135  29.1  7.55\n```\n\n\n:::\n:::\n\n\n\n\n### Summary stats by group\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# BMI summary by gender\nnhanes.samp.adult %>%\n  group_by(Gender) %>%\n  get_summary_stats(BMI, type = \"mean_sd\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  Gender variable     n  mean    sd\n  <fct>  <fct>    <dbl> <dbl> <dbl>\n1 female BMI         70  29.0  8.82\n2 male   BMI         65  29.2  5.97\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Multiple variables\nnhanes.samp.adult %>%\n  group_by(Gender) %>%\n  get_summary_stats(BMI, Height, Weight, type = \"mean_sd\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 5\n  Gender variable     n  mean    sd\n  <fct>  <fct>    <dbl> <dbl> <dbl>\n1 female BMI         70  29.0  8.82\n2 female Height      70 163.   7.50\n3 female Weight      70  77.3 25.8 \n4 male   BMI         65  29.2  5.97\n5 male   Height      65 177.   7.09\n6 male   Weight      65  91.1 18.9 \n```\n\n\n:::\n:::\n\n\n\n\n**Your notes:**\n\n\n\n\n---\n\n## Data Visualization with ggplot2\n\n`ggplot2` is a powerful package for creating visualizations.\n\n### The grammar of graphics\n\nEvery ggplot has three essential components:\n\n1. **Data** - the dataset you're plotting\n2. **Aesthetics** (`aes()`) - what variables map to x, y, color, etc.\n3. **Geoms** - the type of plot (points, bars, lines, etc.)\n\n---\n\n## Basic ggplot template\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = DATA, mapping = aes(x = X_VAR, y = Y_VAR)) +\n  geom_TYPE()\n```\n:::\n\n\n\n\n**Your notes:**\n\n\n\n\n---\n\n## geom_histogram() - Distribution of one numerical variable\n\nHistograms show the distribution of a single numerical variable.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Distribution of BMI\nggplot(data = nhanes.samp.adult, mapping = aes(x = BMI)) +\n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](08_eda_and_data_viz_code_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Control the number of bins\nggplot(data = nhanes.samp.adult, mapping = aes(x = BMI)) +\n  geom_histogram(bins = 30)\n```\n\n::: {.cell-output-display}\n![](08_eda_and_data_viz_code_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\n\n**Your notes:**\n\n\n\n\n---\n\n## geom_boxplot() - Compare distributions across groups\n\nBoxplots show the distribution of a numerical variable across different groups.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# BMI by gender\nggplot(data = nhanes.samp.adult, mapping = aes(x = Gender, y = BMI)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](08_eda_and_data_viz_code_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# BMI by diabetes status\nggplot(data = nhanes.samp.adult, mapping = aes(x = Diabetes, y = BMI)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](08_eda_and_data_viz_code_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n\n\n**Your notes:**\n\n\n\n\n---\n\n## geom_point() - Scatterplot for two numerical variables\n\nScatterplots show the relationship between two numerical variables.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Height vs Weight\nggplot(data = nhanes.samp.adult, mapping = aes(x = Height, y = Weight)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](08_eda_and_data_viz_code_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Add color by group\nggplot(data = nhanes.samp.adult, mapping = aes(x = Height, y = Weight, color = Gender)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](08_eda_and_data_viz_code_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\n\n\n**Your notes:**\n\n\n\n\n---\n\n## geom_bar() - Bar chart for categorical variables\n\nBar charts show counts or frequencies of categorical variables.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Count of diabetes status\nggplot(data = nhanes.samp.adult, mapping = aes(x = Diabetes)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](08_eda_and_data_viz_code_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Count of education levels\nggplot(data = nhanes.samp.adult, mapping = aes(x = Education)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](08_eda_and_data_viz_code_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n\n\n\n\n**Your notes:**\n\n\n\n\n---\n\n## Combining ggplot with dplyr\n\nYou can pipe data into ggplot!\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter then plot\nnhanes.samp.adult %>%\n  filter(Age >= 50) %>%\n  ggplot(aes(x = Height, y = Weight)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](08_eda_and_data_viz_code_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create new variable then plot\nnhanes.samp.adult %>%\n  mutate(bmi_category = case_when(\n    BMI < 25 ~ \"Normal or underweight\",\n    BMI >= 25 ~ \"Overweight or obese\"\n  )) %>%\n  ggplot(aes(x = bmi_category)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](08_eda_and_data_viz_code_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n\n\n\n**Your notes:**\n\n\n\n\n---\n\n## Saving your work\n\nRemember: all these operations create NEW data frames - they don't modify the original!\n\nTo save your work, use the assignment operator `<-`:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Save filtered data\nadults_with_diabetes <- nhanes.samp.adult %>%\n  filter(Diabetes == \"Yes\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Save data with new variables\nnhanes_with_bmi_cat <- nhanes.samp.adult %>%\n  mutate(bmi_category = case_when(\n    BMI < 18.5 ~ \"Underweight\",\n    BMI < 25 ~ \"Normal\",\n    BMI < 30 ~ \"Overweight\",\n    BMI >= 30 ~ \"Obese\"\n  ))\n```\n:::\n\n\n\n\n**Your notes:**\n\n\n\n\n---\n\n## Key takeaways\n\n- **Pipes (`%>%`)** let you chain operations together\n- **`dplyr` verbs** manipulate data: `filter()`, `select()`, `mutate()`, `group_by()`\n- **`janitor::tabyl()`** makes clean frequency tables\n- **`rstatix::get_summary_stats()`** calculates summary statistics easily\n- **`ggplot2`** creates visualizations using data + aesthetics + geoms\n- **Nothing changes your original data** unless you explicitly save it with `<-`\n\n---\n\n## Practice on your own\n\nTry these exercises:\n\n1. Filter the data to people with BMI > 30\n2. Create a scatterplot of Age vs BMI\n3. Calculate mean height by gender\n4. Make a histogram of Age\n5. Create a two-way table of Gender and Diabetes status\n\n**Your notes:**\n",
    "supporting": [
      "08_eda_and_data_viz_code_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}