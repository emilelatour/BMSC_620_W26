{
  "hash": "cc831e3b8b6c61f7b66d81c31a77b495",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Bayes' Theorem\"\nauthor: \"Emile Latour, Nicky Wakim, Meike Niederhausen\"\ndate: \"2026-01-19\"\ndate-format: long\nformat:\n  revealjs:\n    theme: \"../../assets/css/reveal-bmsc620_v4.scss\"\n    slide-number: true\n    show-slide-number: all\n    width: 1955\n    height: 1100\n    footer: \"BMSC 620 | Bayes' Theorem\"\n    html-math-method: mathjax\n    header-includes: |\n      <style>\n      #wrap {\n        width: 1650px;\n        height: 900px;\n        margin: 0 auto;\n        overflow: hidden;\n        border: 1px solid #999;\n        border-radius: 8px;\n      }\n      #frame {\n        width: 1650px;\n        height: 900px;\n        border: 0;\n        zoom: 1.25;\n        -moz-transform: scale(1.25);\n        -moz-transform-origin: 0 0;\n      }\n      /* Make selected tables bigger in RevealJS slides (robust to flextable output) */\n      .reveal .tbl-big {\n        font-size: 28px !important;\n        /* center the output block inside the column */\n        display: flex;\n        justify-content: center;\n      \n        /* scale from center */\n        transform: scale(1.6);\n        transform-origin: top center;\n      }\n      .reveal .tbl-big table,\n      .reveal .tbl-big .flextable,\n      .reveal .tbl-big .flextable table {\n        font-size: 28px !important;\n      }\n      .reveal .tbl-big td,\n      .reveal .tbl-big th {\n        padding: 6px 10px !important;\n      }\n      </style>\nexecute:\n  echo: true\n  freeze: auto\n---\n\n\n\n\n\n## Recap: What we did last time\n\n\\\n\nLast class, we calculated the **Positive Predictive Value (PPV)** using a contingency table:\n\n\\\n\n|            | Disease | No Disease | Total |\n|------------|:-------:|:----------:|:-----:|\n| **Test +** | 90      | 990        | 1,080 |\n| **Test -** | 10      | 8,910      | 8,920 |\n| **Total**  | 100     | 9,900      | 10,000 |\n\n\\\n\n$$P(\\text{Disease} \\mid \\text{Test +}) = \\frac{90}{1,080} \\approx 0.083$$\n\n\\\n\nToday we'll see the **formula** that lets us calculate this directly.\n\n# Bayes' Theorem\n\n## The question we're asking\n\n\\\n\nWe want to **flip the conditional probability**:\n\n\\\n\n::: columns\n::: {.column width=\"50%\"}\n\n**What we know:**\n\n- $P(\\text{Test +} \\mid \\text{Disease})$ (sensitivity)\n- $P(\\text{Test +} \\mid \\text{No Disease})$ (1 - specificity)\n- $P(\\text{Disease})$ (prevalence)\n\n:::\n\n::: {.column width=\"50%\"}\n\n**What we want:**\n\n- $P(\\text{Disease} \\mid \\text{Test +})$ (PPV)\n\n:::\n:::\n\n\\\n\nBayes' Theorem gives us a formula to \"flip\" the conditional.\n\n## Bayes' Theorem: General form\n\n\\\n\n$$\nP(A \\mid B) = \\frac{P(B \\mid A) \\times P(A)}{P(B)}\n$$\n\n\\\n\n**In words:**\n\n- $P(A \\mid B)$ = **posterior** (what we want to know)\n- $P(B \\mid A)$ = **likelihood** (what we can measure)\n- $P(A)$ = **prior** (base rate)\n- $P(B)$ = **marginal probability** of $B$\n\n## Bayes' Theorem: Medical testing version\n\n\\\n\nFor our diagnostic test:\n\n$$\nP(\\text{Disease} \\mid \\text{Test +}) = \\frac{P(\\text{Test +} \\mid \\text{Disease}) \\times P(\\text{Disease})}{P(\\text{Test +})}\n$$\n\n\\\n\n**In words:**\n\n- $P(\\text{Disease} \\mid \\text{Test +})$ = PPV (what we want)\n- $P(\\text{Test +} \\mid \\text{Disease})$ = sensitivity (what test manufacturer tells us)\n- $P(\\text{Disease})$ = prevalence (base rate in population)\n- $P(\\text{Test +})$ = overall rate of positive tests\n\n## The tricky part: $P(\\text{Test +})$\n\n\\\n\nHow do we find $P(\\text{Test +})$?\n\n\\\n\nThere are **two ways** to test positive:\n\n1. Have disease AND test positive: $P(\\text{Disease and Test +})$\n2. No disease AND test positive: $P(\\text{No Disease and Test +})$\n\n\\\n\nUsing the **law of total probability**:\n\n$$\nP(\\text{Test +}) = P(\\text{Test +} \\mid \\text{Disease}) \\times P(\\text{Disease}) + P(\\text{Test +} \\mid \\text{No Disease}) \\times P(\\text{No Disease})\n$$\n\n## Bayes' Theorem: Complete formula\n\n\\\n\n$$\nP(\\text{Disease} \\mid \\text{Test +}) = \\frac{P(\\text{Test +} \\mid \\text{Disease}) \\times P(\\text{Disease})}{P(\\text{Test +} \\mid \\text{Disease}) \\times P(\\text{Disease}) + P(\\text{Test +} \\mid \\text{No Disease}) \\times P(\\text{No Disease})}\n$$\n\n\\\n\nThis looks complicated, but we have all the pieces!\n\n## Applying Bayes' Theorem to our example\n\n\\\n\n**Given:**\n\n- Sensitivity = 90% = $P(\\text{Test +} \\mid \\text{Disease}) = 0.90$\n- Specificity = 90%, so $P(\\text{Test +} \\mid \\text{No Disease}) = 0.10$\n- Prevalence = 1% = $P(\\text{Disease}) = 0.01$\n- Therefore: $P(\\text{No Disease}) = 0.99$\n\n## Step 1: Calculate the numerator\n\n\\\n\n$$\n\\begin{aligned}\n\\text{Numerator} &= P(\\text{Test +} \\mid \\text{Disease}) \\times P(\\text{Disease}) \\\\\n&= 0.90 \\times 0.01 \\\\\n&= 0.009\n\\end{aligned}\n$$\n\n\\\n\nThis represents the **true positives** (people who have disease AND test positive).\n\n## Step 2: Calculate the denominator\n\n\\\n\n$$\n\\begin{aligned}\n\\text{Denominator} &= P(\\text{Test +} \\mid \\text{Disease}) \\times P(\\text{Disease}) \\\\\n&\\quad + P(\\text{Test +} \\mid \\text{No Disease}) \\times P(\\text{No Disease}) \\\\\n&= (0.90 \\times 0.01) + (0.10 \\times 0.99) \\\\\n&= 0.009 + 0.099 \\\\\n&= 0.108\n\\end{aligned}\n$$\n\n\\\n\nThis represents **all positive tests** (true positives + false positives).\n\n## Step 3: Calculate PPV\n\n\\\n\n$$\n\\begin{aligned}\nP(\\text{Disease} \\mid \\text{Test +}) &= \\frac{0.009}{0.108} \\\\\n&\\approx 0.083 \\\\\n&= 8.3\\%\n\\end{aligned}\n$$\n\n\\\n\n**Same answer as before!** But now we calculated it directly from the formula.\n\n## Connecting to the contingency table\n\n\\\n\n::: columns\n::: {.column width=\"50%\"}\n\n**Bayes' Theorem:**\n\n$$\n\\frac{0.90 \\times 0.01}{(0.90 \\times 0.01) + (0.10 \\times 0.99)} = 0.083\n$$\n\n\\\n\n**Numerator:** true positives\n\n**Denominator:** all positives\n\n:::\n\n::: {.column width=\"50%\"}\n\n**Contingency table:**\n\n|            | Disease | No Disease | Total |\n|------------|:-------:|:----------:|:-----:|\n| **Test +** | [90]{style=\"color:red;\"}      | [990]{style=\"color:blue;\"}        | [1,080]{style=\"color:purple;\"} |\n| **Test -** | 10      | 8,910      | 8,920 |\n| **Total**  | 100     | 9,900      | 10,000 |\n\n\\\n\n$$\\frac{\\textcolor{red}{90}}{\\textcolor{purple}{1,080}} = 0.083$$\n\n:::\n:::\n\n\\\n\nThe formula gives us the **proportions** directly!\n\n## Why is this useful?\n\n\\\n\n**Without Bayes' Theorem:**\n\n- Build entire contingency table\n- Need to choose a population size\n- More steps, more chances for errors\n\n\\\n\n**With Bayes' Theorem:**\n\n- Plug numbers directly into formula\n- Get answer immediately\n- Works with any probabilities (don't need counts)\n\n\\\n\nBoth approaches work - use whichever makes more sense to you!\n\n\n## What to remember about Bayes' Theorem\n\n\\\n\n**The formula:**\n\n$$\nP(A \\mid B) = \\frac{P(B \\mid A) \\times P(A)}{P(B)}\n$$\n\n\\\n\n**Key concepts:**\n\n- Bayes' Theorem \"flips\" conditional probabilities\n- Always consider **base rates** (priors)\n- Low prevalence → low PPV, even with accurate tests\n- Can use formula OR contingency table (both work!)\n- **Posterior = (Likelihood × Prior) / Evidence**\n\n## Bayes vs. Contingency tables\n\n\\\n\n::: columns\n::: {.column width=\"50%\"}\n\n**Contingency table approach:**\n\n**Pros:**\n\n- Visual and intuitive\n- See all relationships\n- Good for teaching\n\n**Cons:**\n\n- Requires choosing population size\n- More steps\n- Can't easily see effect of changing parameters\n\n:::\n\n::: {.column width=\"50%\"}\n\n**Bayes' Theorem approach:**\n\n**Pros:**\n\n- Direct calculation\n- Works with proportions\n- Easy to see how prevalence affects PPV\n\n**Cons:**\n\n- Formula can seem abstract\n- Need to remember to calculate denominator\n\n:::\n:::\n\n\\\n\n**Use whichever approach makes more sense to you!**\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}