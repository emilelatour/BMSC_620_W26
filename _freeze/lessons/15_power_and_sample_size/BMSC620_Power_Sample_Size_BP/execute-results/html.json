{
  "hash": "eb6f835b75c0b1e98dc17811c3841a38",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Power and Sample Size\"\nsubtitle: \"Textbook Section 5.4\"\nauthor: \"Emile Latour, Nicky Wakim, Meike Niederhausen\"\ndate: \"2026-02-18\"\ndate-format: long\nformat:\n  revealjs:\n    theme: \"../../assets/css/reveal-bmsc620_v5.scss\"\n    slide-number: true\n    show-slide-number: all\n    width: 1955\n    height: 1100\n    footer: \"BMSC 620 | Power and Sample Size\"\n    html-math-method: mathjax\n    chalkboard: true\nexecute:\n  echo: true\n  warning: false\n  message: false\n  freeze: auto\n---\n\n\n\n\n\n# Learning Objectives\n\nBy the end of today, you will be able to:\n\n1. Define Type I error, Type II error, and power  \n2. Explain how alpha, effect size, variability, and sample size are related  \n3. Calculate required sample size using `pwr.t.test()`  \n4. Interpret power in the context of a clinical trial  \n\n---\n\n# The Through-Line Example\n\n## New Blood Pressure Drug\n\nResearch Question:  \nDoes a new drug reduce systolic blood pressure more than placebo?\n\nDesign:  \nTwo independent groups (randomized)\n\nPrimary endpoint:  \nChange in systolic BP (mmHg)\n\n---\n\n# What must we decide before the trial?\n\n- Significance level (alpha)\n- Desired power\n- Clinically meaningful difference (Delta)\n- Expected variability (sigma)\n- Sample size (n)\n\nKey question:  \nIf the true reduction is 5 mmHg, how likely are we to detect it?\n\n---\n\n# The Four Components in Equilibrium\n\nIn any hypothesis test, four quantities are mathematically linked:\n\n1. Significance level (alpha)  \n2. Effect size (Delta or Cohen's d)  \n3. Sample size (n)  \n4. Power (1 - beta)\n\nIf you fix any three, the fourth is determined.\n\n---\n\n# Type I and Type II Errors\n\n| Reality | H0 True | H0 False |\n|----------|----------|-----------|\n| Reject H0 | Type I error (alpha) | Power (1 - beta) |\n| Fail to reject H0 | Correct (1 - alpha) | Type II error (beta) |\n\nPower = Probability of detecting a real effect when it exists.\n\n---\n\n# Translating to Effect Size\n\nSuppose:\n\n- Clinically meaningful difference: Delta = 5 mmHg  \n- Expected SD: sigma = 10 mmHg  \n\nCohen's d:\n\n$$\nd = \\frac{\\Delta}{\\sigma}\n$$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndelta <- 5\nsigma <- 10\n\nd <- delta / sigma\nd\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.5\n```\n\n\n:::\n:::\n\n\n\n---\n\n# Calculating Required Sample Size\n\nWe want:\n\n- alpha = 0.05  \n- power = 0.80  \n- two independent groups  \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresult <- pwr.t.test(\n  d = d,\n  sig.level = 0.05,\n  power = 0.80,\n  type = \"two.sample\",\n  alternative = \"two.sided\"\n)\n\nresult\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n     Two-sample t test power calculation \n\n              n = 63.76561\n              d = 0.5\n      sig.level = 0.05\n          power = 0.8\n    alternative = two.sided\n\nNOTE: n is number in *each* group\n```\n\n\n:::\n:::\n\n\n\nRequired sample size per group:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nceiling(result$n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 64\n```\n\n\n:::\n:::\n\n\n\n---\n\n# Sensitivity Analysis (Live Demo)\n\nChange one assumption at a time:\n\n- sigma = 12  \n- power = 0.90  \n- Delta = 3  \n- alpha = 0.01  \n\nObserve how required n changes.\n\n---\n\n# Why Does This Happen?\n\nRequired n follows this structure:\n\n$$\nn \\propto \n\\frac{(z_{\\alpha/2} + z_{\\beta})^2 \\sigma^2}{\\Delta^2}\n$$\n\nThis tells us:\n\n- Larger sigma -> larger n  \n- Smaller Delta -> larger n  \n- Higher power -> larger n  \n- Smaller alpha -> larger n  \n\n---\n\n# Power Curve\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn_seq <- seq(20, 200, by = 5)\n\npower_vals <- sapply(n_seq, function(n_val) {\n  pwr.t.test(\n    n = n_val,\n    d = d,\n    sig.level = 0.05,\n    type = \"two.sample\"\n  )$power\n})\n\nplot(n_seq, power_vals, type = \"l\",\n     xlab = \"Sample size per group\",\n     ylab = \"Power\",\n     main = \"Power increases with sample size\")\n```\n\n::: {.cell-output-display}\n![](BMSC620_Power_Sample_Size_BP_files/figure-revealjs/unnamed-chunk-4-1.png){width=960}\n:::\n:::\n\n\n\n---\n\n# Practical Reality\n\nPlanned for n = 64 per group  \nRecruited n = 50  \nActual SD = 12  \n\nObserved difference = 4 mmHg  \np = 0.09  \n\nWas the drug ineffective?  \nOr was the study underpowered?\n\n---\n\n# Key Takeaways\n\n1. Power = Probability of detecting a true effect  \n2. Effect size and variability drive required sample size  \n3. Power analysis should be done prospectively  \n4. Sample size decisions are scientific and ethical  \n\n---\n\n# Key R Function\n\n```r\npwr.t.test(\n  n = NULL,\n  d = NULL,\n  sig.level = 0.05,\n  power = NULL,\n  type = \"two.sample\",\n  alternative = \"two.sided\"\n)\n```\n\nLeave out the parameter you want to calculate.\n",
    "supporting": [
      "BMSC620_Power_Sample_Size_BP_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}