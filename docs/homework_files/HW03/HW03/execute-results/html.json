{
  "hash": "0594e13281f1fd3a3bb2c0834e15b844",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"BMSC 620 — Homework 3\"\nauthor: \"Your Name\"\nformat: \n  html:\n    embed-resources: true\nexecute:\n  echo: true\n---\n\n\n\n\n\n\n\n::: {.callout-note}\n**File naming and submission**\n\nPlease use the following file naming convention:\n\n`Lastname_FirstInitial_HW##`\n\nExamples:\n\n- Smith_J_HW03.qmd\n- Smith_J_HW03.html\n\n\nWhen submitting Homework 3, upload **both**:\n\n- the `.qmd` file\n- the rendered `.html` file\n:::\n\n## Homework 3\n\nThis assignment reviews:\n\n- Bayes' Theorem and medical testing\n- Random variables: expected value and variance\n- Binomial distribution and probability calculations\n- Continued practice with `dplyr`, `janitor`, `rstatix`, and `ggplot2`\n\nUnless stated otherwise, show your work using R code chunks.\n\n---\n\n## Part 0: Setup\n\n1. In the chunk below, load the packages you need for this homework.\n2. Run the chunk to confirm there are no errors.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(oibiostat)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(janitor)\nlibrary(rstatix)\n```\n:::\n\n\n\n\n## Part 1: Bayes' Theorem\n\n### Background\n\nA new rapid test for influenza has been developed. Clinical trials show:\n\n- **Sensitivity:** 85% (probability of testing positive given you have flu)\n- **Specificity:** 92% (probability of testing negative given you don't have flu)\n\nDuring flu season, approximately 5% of people who visit their doctor with flu-like symptoms actually have influenza.\n\n### 1A. Set up the problem\n\nWrite out the given information using probability notation:\n\n1. $P(\\text{Test +} \\mid \\text{Flu}) =$ ___________\n2. $P(\\text{Test -} \\mid \\text{No Flu}) =$ ___________\n3. $P(\\text{Test +} \\mid \\text{No Flu}) =$ ___________ (Calculate this from specificity)\n4. $P(\\text{Flu}) =$ ___________\n5. $P(\\text{No Flu}) =$ ___________\n\nFill in your answers above, then verify them in the code chunk below:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Given information\nsensitivity <- \nspecificity <- \nprevalence <- \n\n# Calculate derived values\np_test_pos_given_no_flu <- \np_no_flu <- \n\n# Display\nsensitivity\np_test_pos_given_no_flu\nprevalence\np_no_flu\n```\n:::\n\n\n\n\n### 1B. Calculate PPV using Bayes' Theorem\n\nUse Bayes' Theorem to calculate the Positive Predictive Value (PPV): What is the probability someone has flu given they tested positive?\n\n$$\nP(\\text{Flu} \\mid \\text{Test +}) = \\frac{P(\\text{Test +} \\mid \\text{Flu}) \\times P(\\text{Flu})}{P(\\text{Test +} \\mid \\text{Flu}) \\times P(\\text{Flu}) + P(\\text{Test +} \\mid \\text{No Flu}) \\times P(\\text{No Flu})}\n$$\n\n**Step 1:** Calculate the numerator (true positives)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnumerator <- \n\nnumerator\n```\n:::\n\n\n\n\n**Step 2:** Calculate the denominator (all positive tests)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndenominator <- \n\ndenominator\n```\n:::\n\n\n\n\n**Step 3:** Calculate PPV\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nppv <- \n\nppv\n\n# As a percentage\nppv * 100\n```\n:::\n\n\n\n\n### 1C. Interpretation\n\nAnswer in 2-3 sentences:\n\n1. If someone tests positive, what is the probability they actually have the flu?\n2. Why is the PPV lower than the sensitivity (85%)?\n\n**Answers:**\n\n1. \n2. \n\n### 1D. Calculate NPV\n\nNow calculate the Negative Predictive Value (NPV): What is the probability someone does NOT have flu given they tested negative?\n\n$$\nP(\\text{No Flu} \\mid \\text{Test -}) = \\frac{P(\\text{Test -} \\mid \\text{No Flu}) \\times P(\\text{No Flu})}{P(\\text{Test -} \\mid \\text{No Flu}) \\times P(\\text{No Flu}) + P(\\text{Test -} \\mid \\text{Flu}) \\times P(\\text{Flu})}\n$$\n\nHint: $P(\\text{Test -} \\mid \\text{Flu}) = 1 - \\text{sensitivity}$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate NPV\n```\n:::\n\n\n\n\nWhat is the NPV? Is it higher or lower than the PPV? Why?\n\n**Answer:**\n\n---\n\n## Part 2: Random Variables\n\n### 2A. Discrete probability distribution\n\nA hospital emergency department tracks the number of patients arriving per hour during overnight shifts. The probability distribution is:\n\n| Number of patients ($x$) | 0 | 1 | 2 | 3 | 4 | 5 |\n|--------------------------|---|---|---|---|---|---|\n| $P(X = x)$               | 0.05 | 0.15 | 0.30 | 0.25 | 0.15 | 0.10 |\n\n**Question 1:** Verify this is a valid probability distribution. What must be true?\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create the probability distribution\nx <- c(0, 1, 2, 3, 4, 5)\nprob <- c(0.05, 0.15, 0.30, 0.25, 0.15, 0.10)\n\n# Check if probabilities sum to 1\nsum(prob)\n\n# Hint: probabilities in a valid distribution must sum to 1\n# You may find sum() helpful here (see ?sum)\n```\n:::\n\n\n\n\n**Answer:** \n\n**Question 2:** Calculate the expected value (mean). On average, how many patients arrive per hour?\n\n$$E(X) = \\sum x_i \\cdot P(X = x_i)$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate expected value\n# Hint: expected value is a weighted average\n# In R, this can be computed as sum(x * prob)\n```\n:::\n\n\n\n\n**Answer:** The expected number of patients per hour is ________.\n\n**Question 3:** Calculate the variance and standard deviation.\n\n$$\\text{Var}(X) = \\sum (x_i - \\mu)^2 \\cdot P(X = x_i)$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate variance\n# Hint: first compute the mean (mu), then use\n# sum((x - mu)^2 * prob)\n\n\n\n# Calculate standard deviation\n# Hint: SD is the square root of the variance (see sqrt())\n```\n:::\n\n\n\n\n**Answer:** \n\n- Variance = ________\n- Standard deviation = ________\n\n### 2B. Linear combinations\n\nSuppose the hospital emergency department operates for 3 hours during an overnight shift. Let $X_1$, $X_2$, and $X_3$ be the number of patients arriving in hours 1, 2, and 3, respectively. Assume each has the same distribution as above and arrivals are independent across hours.\n\n**Question 1:** What is the expected total number of patients arriving during the 3-hour shift?\n\nUse: $E(X_1 + X_2 + X_3) = E(X_1) + E(X_2) + E(X_3)$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate expected total\n```\n:::\n\n\n\n\n**Answer:**\n\n**Question 2:** What is the variance and standard deviation of the total number of patients?\n\nUse: $\\text{Var}(X_1 + X_2 + X_3) = \\text{Var}(X_1) + \\text{Var}(X_2) + \\text{Var}(X_3)$ (for independent random variables)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate variance of total\n\n\n# Calculate standard deviation of total\n```\n:::\n\n\n\n\n**Answer:**\n\n- Variance = ________\n- Standard deviation = ________\n\n---\n\n## Part 3: Binomial Distribution\n\n### 3A. Identifying binomial scenarios\n\nFor each scenario below, state whether it follows a binomial distribution. If yes, identify $n$ (number of trials) and $p$ (probability of success). If no, explain why not.\n\n**Scenario 1:** A researcher tests 20 patients for a genetic mutation. Each patient has a 15% chance of having the mutation. We count how many patients have the mutation.\n\n**Answer:**\n\n**Scenario 2:** A doctor sees patients until they find 5 patients with high blood pressure. We count how many patients the doctor had to see.\n\n**Answer:**\n\n**Scenario 3:** A clinical trial enrolls 50 patients. Each patient is randomly assigned to treatment (probability 0.5) or control (probability 0.5). We count how many patients receive treatment.\n\n**Answer:**\n\n### 3B. Binomial calculations\n\nAccording to recent data, approximately 20.3% of US adults aged 65-74 have diabetes. Suppose we randomly sample 15 adults from this age group.\n\nLet $X$ = the number of adults with diabetes in our sample.\n\n**Question 1:** What distribution does $X$ follow? Write this using notation.\n\n**Answer:** $X \\sim$ ________________\n\n**Question 2:** What is the expected number of adults with diabetes in the sample?\n\n$$E(X) = np$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate expected value\nn <- \np <- \n\nexpected_value <- \n\nexpected_value\n```\n:::\n\n\n\n\n**Answer:**\n\n**Question 3:** What is the standard deviation?\n\n$$SD(X) = \\sqrt{np(1-p)}$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate standard deviation\n```\n:::\n\n\n\n\n**Answer:**\n\n**Question 4:** What is the probability that exactly 4 adults have diabetes?\n\nUse the formula: $P(X = k) = \\binom{n}{k} p^k (1-p)^{n-k}$\n\nOr use R: `dbinom(x = k, size = n, prob = p)`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate P(X = 4)\n```\n:::\n\n\n\n\n**Answer:**\n\n**Question 5:** What is the probability that at most 2 adults have diabetes?\n\n$$P(X \\leq 2) = P(X=0) + P(X=1) + P(X=2)$$\n\nUse R: `pbinom(q = k, size = n, prob = p)`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate P(X <= 2)\n```\n:::\n\n\n\n\n**Answer:**\n\n**Question 6:** What is the probability that at least 5 adults have diabetes?\n\n$$P(X \\geq 5) = 1 - P(X \\leq 4)$$\n\nOr use: `pbinom(q = 4, size = n, prob = p, lower.tail = FALSE)`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate P(X >= 5) using both methods\n\n# Method 1: complement rule\n\n\n# Method 2: lower.tail = FALSE\n```\n:::\n\n\n\n\n**Answer:**\n\n### 3C. Visualizing the binomial distribution\n\nCreate a bar plot showing the binomial probability distribution for $n = 15$ and $p = 0.203$.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create probability distribution data\nx_values <- 0:15\nprobabilities <- dbinom(x_values, size = 15, prob = 0.203)\n\n# Create a data frame\nbinom_data <- data.frame(\n  x = x_values,\n  probability = probabilities\n)\n\n# Create bar plot\nggplot(binom_data, aes(x = x, y = probability)) +\n  geom_col(fill = \"steelblue\", color = \"black\") +\n  labs(\n    title = \"Binomial Distribution: n = 15, p = 0.203\",\n    x = \"Number of Adults with Diabetes\",\n    y = \"Probability\"\n  ) +\n  scale_x_continuous(breaks = 0:15) # controls x-axis tick marks (we'll learn more about scale_* later; see ?scale_x_continuous)\n```\n:::\n\n\n\n\nLooking at the plot, what is the most likely number of adults with diabetes in a sample of 15? Does this match the expected value you calculated?\n\n**Answer:**\n\n---\n\n## Part 4: Data analysis with tidyverse (continued practice)\n\nFor this section, we'll continue working with the `nhanes.samp` dataset. You may use either the formula or R, but show the code you use.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"nhanes.samp\")\n```\n:::\n\n\n\n\n### 4A. Data wrangling\n\nCreate a new dataset called `diabetes_subset` that:\n\n1. Filters to people aged 40 or older\n2. Removes rows with missing `Diabetes` values (use `filter(!is.na(Diabetes))`)\n3. Selects the columns: `ID`, `Age`, `Gender`, `Race1`, `BMI`, `Diabetes`\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\nHow many people are in this subset? (Use `nrow()`)\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n**Answer:**\n\n### 4B. Summary statistics by group\n\nUsing your `diabetes_subset`, calculate the mean and standard deviation of `BMI` grouped by `Diabetes` status. [Hint: use `group_by` and `get_summary_stats` from the `rstatix` pacakge]\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\nDo people with diabetes have higher or lower BMI on average? Does this match what you'd expect?\n\n**Answer:**\n\n### 4C. Two-way frequency table\n\nCreate a two-way table showing the relationship between `Diabetes` and `Gender` using `tabyl()`. Add row percentages.\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\nAmong people aged 40+, what percentage of females have diabetes? What about males?\n\n**Answer:**\n\n### 4D. Visualization\n\nCreate a boxplot comparing `BMI` across `Diabetes` groups. Color the boxes by `Diabetes` status.\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\nDescribe what you see in 1-2 sentences.\n\n**Answer:**\n\n---\n\n## Part 5: Connecting concepts (Integration)\n\n### 5A. Binomial to data\n\nIn Part 3, we calculated that with $n=15$ and $p=0.203$, the expected number of adults with diabetes is approximately 3.\n\nNow let's check this against real data. Using the full `nhanes.samp` dataset:\n\n1. Filter to adults aged 65-74 (use `filter(Age >= 65 & Age <= 74)`)\n2. Calculate the proportion who have diabetes (use `tabyl(Diabetes)`)\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n**Questions:**\n\n1. What proportion of adults aged 65-74 in this sample have diabetes?\n2. How does this compare to the 20.3% we used in our binomial calculations?\n3. If you randomly selected 15 people from this sample, would you expect about 3 to have diabetes?\n\n**Answers:**\n\n1. \n2. \n3. \n\n### 5B. Bayes' Theorem with data\n\nSuppose we use `BMI >= 30` as a \"test\" for diabetes (obese BMI as a predictor).\n\nCalculate the following using the `diabetes_subset` you created in Part 4A:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create BMI test variable\ndiabetes_subset <- diabetes_subset %>%\n  mutate(BMI_test = if_else(BMI >= 30, \"Positive\", \"Negative\"))\n\n# Create contingency table\ntable_diabetes_bmi <- diabetes_subset %>%\n  tabyl(Diabetes, BMI_test)\n\ntable_diabetes_bmi\n```\n:::\n\n\n\n\nTreat BMI_test as the test result and Diabetes as the true condition.\n\n- \"Positive\" = BMI ≥ 30\n- \"Negative\" = BMI < 30\n\n\n**Question 1:** What is the sensitivity? (Among people with diabetes, what proportion have BMI >= 30?)\n\nHint: Look at the \"Yes\" row of the Diabetes column\n\n**Answer:**\n\n**Question 2:** What is the specificity? (Among people without diabetes, what proportion have BMI < 30?)\n\n**Answer:**\n\n**Question 3:** Using the table, calculate the PPV: Among people with BMI >= 30, what proportion have diabetes?\n\n**Answer:**\n\n---\n\n## Part 6: Reflection (Optional but encouraged)\n\nIn 3-4 sentences, reflect on the connection between:\n\n- Bayes' Theorem (flipping conditional probabilities)\n- Binomial distribution (modeling repeated trials)\n- Real data analysis (testing these concepts)\n\nHow do these topics relate to biomedical research?\n\n**Answer:**\n\n---\n\n## Final check\n\nBefore submitting, confirm that:\n\n- The document renders to HTML without errors\n- All code chunks run successfully\n- Your name appears at the top\n- You've answered all required questions\n- You uploaded both the .qmd and .html files\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}