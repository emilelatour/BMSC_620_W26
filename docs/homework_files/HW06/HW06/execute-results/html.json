{
  "hash": "964dd680710eabbe4968f83fc4c34e4b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"BMSC 620 — Homework 6\"\nsubtitle: \"Power Analysis and Inference for Proportions\"\nauthor: \"Your Name\"\nformat: \n  html:\n    embed-resources: true\n    toc: true\nexecute:\n  echo: true\n---\n\n\n\n\n\n\n::: {.callout-note}\n**File naming and submission**\n\nPlease use the following file naming convention:\n\n`Lastname_FirstInitial_HW06`\n\nExamples:\n\n- Smith_J_HW06.qmd\n- Smith_J_HW06.html\n\nWhen submitting Homework 6, upload **both**:\n\n- the `.qmd` file\n- the rendered `.html` file\n:::\n\n## Instructions\n\n- Answer each question clearly and concisely.\n- Show your work using R code chunks.\n- **Rounding:** Round proportions and confidence intervals to 3 decimal places.\n  Round *p*-values to 3 decimal places (or report as *p* < 0.001 if very small).\n- This homework uses **external data files** — see Part 0 below before writing\n  any code.\n- Code chunks marked `# Your code here` are intentionally blank. You are\n  expected to write the code yourself. Hints are provided to guide you.\n\n::: {.callout-note}\n**A note on this homework**\n\nThis assignment covers two lectures that may feel a bit disconnected: power\nanalysis (for *t*-tests) and inference for proportions. Don't worry — that\nreflects where we are in the course. We will return to power analysis later\nin the semester when we discuss proportions and more complex designs.\nFor now, think of Part 1 as consolidating your understanding of power before\nwe move on, and Parts 2–5 as introducing the new inference framework we'll be\nusing for categorical outcomes.\n:::\n\n---\n\n## Part 0: Project Setup\n\n**Before writing any code, do the following:**\n\n1. Make sure you are working inside your BMSC 620 R Project.\n2. Download the data file from OneDrive and place it inside your\n   project's `data/` folder:\n   - `cardiac_trial.csv`\n3. Your folder structure should look like this:\n\n```\nBMSC620/\n├── BMSC620.Rproj\n├── data/\n│   ├── cardiac_trial.csv\n└── homework/\n    └── Smith_J_HW06.qmd    ← your file goes here\n```\n\nLoad the packages you will need:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(here)\nlibrary(broom)\nlibrary(rstatix)\nlibrary(janitor)\nlibrary(pwr)\n```\n:::\n\n\n\n\n---\n\n## Part 1: Power Analysis for *t*-Tests\n\n### Background\n\nA research team is planning a randomized controlled trial to evaluate whether\na new exercise intervention reduces resting heart rate in sedentary adults.\nBased on pilot data, they expect:\n\n- Mean resting heart rate in the **control group** (standard care): 75 bpm\n- Mean resting heart rate in the **intervention group**: 71 bpm (a 4 bpm reduction)\n- Standard deviation in both groups: approximately 8 bpm\n- They want **80% power** at $\\alpha = 0.05$ (two-sided)\n\n---\n\n### 1A. Calculate Cohen's *d*\n\nBefore using `pwr.t.test()`, compute the standardized effect size (Cohen's *d*)\nfor this scenario.\n\n::: {.callout-tip}\nFor a two-sample design, Cohen's *d* is the expected difference divided by the\ncommon standard deviation. You can compute it directly in R and assign it to\nan object called `d_heart` for use in the next question.\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Your code here\n```\n:::\n\n\n\n\nIs this a small, medium, or large effect by Cohen's conventional thresholds\n(0.2 / 0.5 / 0.8)?\n\n**Answer:**\n\n---\n\n### 1B. Find the required sample size\n\nUse `pwr.t.test()` to determine how many participants are needed **per group**\nto achieve the desired power. Round up to the nearest whole person.\n\n::: {.callout-tip}\nLeave `n = NULL` to find the sample size. Set `type = \"two.sample\"` since\nparticipants are randomized to independent groups. Remember that `pwr.t.test()`\nreturns the per-group *n*, so total sample size = 2 × *n*.\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Your code here\n```\n:::\n\n\n\n\nHow many participants are needed in total across both groups?\n\n**Answer:**\n\n---\n\n### 1C. Calculate power for a budget-constrained design\n\nThe research team receives funding for only **40 participants per group**\n(80 total). Using the same effect size and significance level, what power\nwill this study have?\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Your code here\n```\n:::\n\n\n\n\nWrite a sentence interpreting this power value. If the intervention truly\nreduces resting heart rate by 4 bpm, what is the probability the study\nwill detect it?\n\n**Answer:**\n\n---\n\n### 1D. Reflect on the trade-off\n\nThe team is deciding whether to proceed with 40 participants per group.\nIn 2–3 sentences, discuss the implications of the power level you found\nin 1C. What does it mean for the study if $H_0$ is false but the study\nfails to reject it?\n\n**Answer:**\n\n---\n\n## Part 2: Single Proportion Inference\n\n### Background\n\nThe `cardiac_trial.csv` dataset comes from a simulated randomized controlled\ntrial of **400 patients** with elevated cardiovascular risk. Patients were\nrandomized 1:1 to receive either a statin medication or a placebo for two\nyears. The primary outcome was **MACE** — a major adverse cardiac event\n(heart attack, stroke, or cardiovascular death) — recorded as `Yes` or `No`.\n\n> *Data simulated for educational purposes. Values do not represent real\n> patient data.*\n\n---\n\n### 2A. Load and inspect the data\n\nImport `cardiac_trial.csv` and assign it to an object called `cardiac`.\nUse `glimpse()` to inspect the structure.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Your code here\n```\n:::\n\n\n\n\nHow many patients are in each treatment group? How many experienced a MACE\nevent overall?\n\n::: {.callout-tip}\n`janitor::tabyl()` is a convenient way to count observations. Try\n`tabyl(treatment)` and `tabyl(mace)` to answer both parts.\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Your code here\n```\n:::\n\n\n\n\n**Answer:**\n\n---\n\n### 2B. Tabulate MACE by treatment group\n\nCreate a two-way frequency table showing MACE outcome by treatment group.\n\n::: {.callout-tip}\n`tabyl(treatment, mace)` will cross-tabulate the two variables. Pipe the\nresult into `adorn_totals(c(\"row\", \"col\"))` to add row and column totals.\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Your code here\n```\n:::\n\n\n\n\nBased on the table, what is the observed MACE rate in each group?\n\n**Answer:**\n\n---\n\n### 2C. Test the statin group against a historical benchmark\n\nHistorical data from similar high-risk populations suggests a two-year MACE\nrate of approximately **15%** without treatment. We want to know whether the\nstatin group's MACE rate is **lower than** this historical benchmark.\n\n**State the hypotheses** for this one-sided test. Let $p$ be the true MACE\nprobability for patients receiving statins.\n\n**Answer:**\n\n$$H_0: $$\n\n$$H_A: $$\n\n---\n\n### 2D. Check the success-failure condition\n\nBefore running the test, verify that the normal approximation is appropriate\nfor the statin group.\n\n::: {.callout-tip}\nUnder $H_0$, check $np_0 \\geq 10$ and $n(1-p_0) \\geq 10$ using the null\nvalue $p_0 = 0.15$ and the statin group sample size.\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Your code here\n```\n:::\n\n\n\n\nIs the success-failure condition met? Briefly explain.\n\n**Answer:**\n\n---\n\n### 2E. Run the one-sample proportion test\n\nTest whether the statin group's MACE rate is lower than the 15% historical benchmark. Use the appropriate one-sided alternative and `correct = TRUE`.\n\n::: {.callout-tip}\n\nYou can use either `rstatix::prop_test()` or base R's `prop.test()` plus `broom::tidy()` — both produce the same results.\n\nYou will need `x` (number of MACE events in the statin group) and `n`\n(statin group size). You can extract these from your table in 2B, or\nuse `filter()` and `summarize()` to compute them from `cardiac`.\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Your code here\n```\n:::\n\n\n\n\nReport the test statistic, p-value, and 95% confidence interval.\nWrite a 2–3 sentence conclusion in context.\n\n**Answer:**\n\n---\n\n## Part 3: Comparing Two Proportions\n\n### 3A. State the hypotheses\n\nWe now want to formally compare the MACE rate between the statin and placebo\ngroups. Let $p_1$ = MACE probability for statin patients and $p_2$ = MACE\nprobability for placebo patients.\n\nState the null and alternative hypotheses for a **two-sided** test.\n\n**Answer:**\n\n$$H_0: $$\n\n$$H_A: $$\n\n---\n\n### 3B. Check the success-failure condition for both groups\n\nBefore running the test, verify the normal approximation is valid for **both**\ngroups.\n\n::: {.callout-tip}\n\nFor a two-sample test, check success-failure using the pooled proportion under $H_0$. For a CI, check using each group’s observed $\\hat{p}$ values.\n\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Your code here\n```\n:::\n\n\n\n\n**Answer:**\n\n---\n\n### 3C. Run the two-sample proportion test\n\nCompare the proportions for the two groups. Supply `x` and `n` as vectors with the statin group first.\n\n::: {.callout-tip}\n\nYou can use either `rstatix::prop_test()` or base R's `prop.test()` plus `broom::tidy()` — both produce the same results.\n\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Your code here\n```\n:::\n\n\n\n\n---\n\n### 3D. Interpret the results\n\nFill in the blanks and write a complete conclusion.\n\n- Observed MACE rate, statin group ($\\hat{p}_1$): ________\n- Observed MACE rate, placebo group ($\\hat{p}_2$): ________\n- p-value: ________\n- 95% confidence interval for $p_1 - p_2$: (________, ________)\n\n**Conclusion** (2–3 sentences: state which group had higher MACE rates, whether\nthe difference is statistically significant at $\\alpha = 0.05$, and what this\nsuggests about statin therapy in this population):\n\n**Answer:**\n\n---\n\n## Part 4: Measures of Association from a 2×2 Table\n\nUsing the counts from your table in Question 2B, calculate three measures of\nassociation for the cardiac trial data.\n\n---\n\n### 4A. Risk difference\n\nCalculate the risk difference (RD = $\\hat{p}_\\text{statin} - \\hat{p}_\\text{placebo}$).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Your code here\n```\n:::\n\n\n\n\nInterpret the RD in a sentence. What does this mean in practical terms for\npatients?\n\n**Answer:**\n\n---\n\n### 4B. Relative risk\n\nCalculate the relative risk ($RR = \\hat{p}_\\text{statin} / \\hat{p}_\\text{placebo}$).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Your code here\n```\n:::\n\n\n\n\nInterpret the RR. By what percentage does statin therapy reduce the relative\nrisk of MACE? **Hint**: Relative risk reduction = 1 - RR\n\n\n\n**Answer:**\n\n---\n\n### 4C. Odds ratio\n\nCalculate the odds ratio ($OR = \\frac{\\hat{p}_1/(1-\\hat{p}_1)}{\\hat{p}_2/(1-\\hat{p}_2)}$).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Your code here\n```\n:::\n\n\n\n\nIn this dataset, is the OR close to the RR? Why or why not? (Hint: think about\nhow common or rare the outcome is.)\n\n**Answer:**\n\n---\n\n## Part 5: Exact Binomial Inference\n\n### Background\n\nResearchers conducted a small pilot study evaluating post-operative stroke risk following a new cardiac surgery technique. In this study, **4 out of 18 patients** experienced a stroke within 30 days. The historical stroke rate for standard surgical techniques is approximately **3%**.\n\nThe research team wants to know whether the new technique is associated with an\nelevated stroke rate.\n\n---\n\n### 5A. Set up the study values\n\nBased on the background above, assign the key values to named objects for use in the analysis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Your code here\n# Hint: you need n_pilot, x_pilot, and p0_pilot\n```\n:::\n\n\n\n\n---\n\n### 5B. Check the success-failure condition\n\nBefore deciding which test to use, check whether the normal approximation is\nvalid for this scenario.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Check success-failure condition under H0\n# Your code here\n```\n:::\n\n\n\n\nDoes the success-failure condition hold? Which test should you use and why?\n\n**Answer:**\n\n---\n\n### 5C. Run the exact binomial test\n\nUse `rstatix::binom_test()` to test whether the observed stroke rate exceeds\nthe 3% historical benchmark. Use a one-sided alternative.\n\n::: {.callout-tip}\nYou can use either `rstatix::binom_test()` or base R's `binom.test()` plus `broom::tidy()` — both produce exact p-values and Clopper-Pearson confidence intervals.\n\n`binom_test()` takes the same arguments as `prop_test()`: `x`, `n`, `p`,\n`alternative`, and `conf.level`.\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Your code here\n```\n:::\n\n\n\n\n---\n\n### 5D. Interpret the results\n\nReport the exact p-value and the Clopper-Pearson 95% confidence interval for\nthe true stroke rate.\n\nWrite a 2–3 sentence conclusion. What do the results suggest about the safety\nof this surgical technique? Why is the exact test the appropriate choice here?\n\n**Answer:**\n\n---\n\n## Submission checklist\n\nBefore submitting, make sure you have:\n\n- [ ] Both data files are in your `data/` folder\n- [ ] All code chunks run without errors when rendered\n- [ ] Answered all written questions\n- [ ] Interpretations are written in full sentences, in context\n- [ ] Rendered your HTML successfully\n- [ ] Uploaded both `.qmd` and `.html` files\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}